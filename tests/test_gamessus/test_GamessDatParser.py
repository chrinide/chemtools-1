import numpy as np
import os
import re
import unittest

from chemtools.calculators.gamessus import GamessDatParser, get_naos_nmos

class TestGDPonHeH2(unittest.TestCase):
    heh2_rhf = '''--- CLOSED SHELL ORBITALS --- GENERATED AT Sun May 11 14:57:30 2014
He-H2 FCI                                                                       
E(RHF)=       -3.9842266066, E(NUC)=    1.3521176085,    8 ITERS
 $VEC   
 1  1 5.94341142E-01 4.96648283E-01 2.38093259E-02 0.00000000E+00 0.00000000E+00
 1  2 3.65054986E-05 0.00000000E+00 0.00000000E+00-6.20897336E-04 1.66217257E-03
 1  3 8.99199084E-04 5.58556722E-04 0.00000000E+00 1.63595833E-04 1.37021945E-04
 1  4 0.00000000E+00 7.68100142E-04-1.10039928E-03 1.66217257E-03 8.99199084E-04
 1  5 5.58556722E-04 0.00000000E+00-1.63595833E-04 1.37021945E-04 0.00000000E+00
 1  6-7.68100142E-04-1.10039928E-03
 2  1-9.00596442E-03-9.92166094E-03-1.37947380E-03-0.00000000E+00-0.00000000E+00
 2  2 3.15442232E-04-0.00000000E+00-0.00000000E+00 1.55898519E-04 4.01361080E-01
 2  3 1.73534106E-01 7.17373295E-03-0.00000000E+00 2.16962306E-02-9.72101523E-07
 2  4-0.00000000E+00 5.09681092E-03 6.26271405E-06 4.01361080E-01 1.73534106E-01
 2  5 7.17373295E-03-0.00000000E+00-2.16962306E-02-9.72101523E-07-0.00000000E+00
 2  6-5.09681092E-03 6.26271405E-06
 3  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-1.94514726E-03
 3  2-0.00000000E+00-0.00000000E+00-3.25528355E-03-0.00000000E+00 5.00775117E-02
 3  3-2.16848536E+00 4.32699827E+00-0.00000000E+00-1.83746968E-03 5.39647224E-05
 3  4-0.00000000E+00-5.43254135E-01-1.07581522E-03-5.00775117E-02 2.16848536E+00
 3  5-4.32699827E+00-0.00000000E+00-1.83746968E-03-5.39647224E-05-0.00000000E+00
 3  6-5.43254135E-01 1.07581522E-03
 4  1-3.05234025E-02-4.06841135E-02-1.74220090E-01-0.00000000E+00-0.00000000E+00
 4  2 4.34466234E-03-0.00000000E+00-0.00000000E+00-2.38819857E-02-6.08577947E-02
 4  3-3.75435126E-01 7.36067528E-01-0.00000000E+00-1.31356432E-02 5.14638178E-04
 4  4-0.00000000E+00 7.12105764E-02 6.75460460E-03-6.08577947E-02-3.75435126E-01
 4  5 7.36067528E-01-0.00000000E+00 1.31356432E-02 5.14638178E-04-0.00000000E+00
 4  6-7.12105764E-02 6.75460460E-03
 5  1-1.41697620E-01-6.29282968E-01 1.34588277E+00 0.00000000E+00 0.00000000E+00
 5  2-1.52618951E-04 0.00000000E+00 0.00000000E+00 6.90874107E-03-9.82085055E-03
 5  3 6.52718216E-02-2.03640543E-01 0.00000000E+00 1.62613155E-03-3.71799345E-03
 5  4 0.00000000E+00-5.59572047E-02-1.02909580E-01-9.82085055E-03 6.52718216E-02
 5  5-2.03640543E-01 0.00000000E+00-1.62613155E-03-3.71799345E-03 0.00000000E+00
 5  6 5.59572047E-02-1.02909580E-01
 6  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00 7.31317589E-04
 6  2-0.00000000E+00-0.00000000E+00-1.59082394E-02-0.00000000E+00 1.67263691E-01
 6  3 1.00213063E+01-3.14852088E+00-0.00000000E+00-4.03863045E-02 1.19245387E-04
 6  4-0.00000000E+00 2.10470950E+00-3.62726158E-03-1.67263691E-01-1.00213063E+01
 6  5 3.14852088E+00-0.00000000E+00-4.03863045E-02-1.19245387E-04-0.00000000E+00
 6  6 2.10470950E+00 3.62726158E-03
 7  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-3.22124256E-03-0.00000000E+00
 7  2-0.00000000E+00 6.61863580E-02-0.00000000E+00-0.00000000E+00-0.00000000E+00
 7  3-0.00000000E+00-0.00000000E+00-1.24202650E-02-0.00000000E+00-0.00000000E+00
 7  4 5.21289366E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
 7  5-0.00000000E+00-1.24202650E-02-0.00000000E+00-0.00000000E+00 5.21289366E-01
 7  6-0.00000000E+00-0.00000000E+00
 8  1-3.42587258E-02-2.91087042E-01 6.94407086E-01 0.00000000E+00 0.00000000E+00
 8  2 6.50957355E-03 0.00000000E+00 0.00000000E+00-2.45083253E-01 3.08611088E-02
 8  3-3.10008034E-02-1.01684006E-01 0.00000000E+00-1.20233571E-03-1.20374379E-02
 8  4 0.00000000E+00 6.73882805E-02 4.93621562E-01 3.08611088E-02-3.10008034E-02
 8  5-1.01684006E-01 0.00000000E+00 1.20233571E-03-1.20374379E-02 0.00000000E+00
 8  6-6.73882805E-02 4.93621562E-01
 9  1-3.62319168E-03 1.85029027E-02-1.79706205E-01-0.00000000E+00-0.00000000E+00
 9  2 2.87643500E-03-0.00000000E+00-0.00000000E+00-1.05699070E-02 1.88675933E-01
 9  3-8.49022834E-01 4.26416839E-01-0.00000000E+00-1.70909112E-02-5.55314816E-04
 9  4-0.00000000E+00 1.26662516E+00-6.30050635E-02 1.88675933E-01-8.49022834E-01
 9  5 4.26416839E-01-0.00000000E+00 1.70909112E-02-5.55314816E-04-0.00000000E+00
 9  6-1.26662516E+00-6.30050635E-02
10  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 1.17233606E-02
10  2 0.00000000E+00 0.00000000E+00-4.07549826E-01 0.00000000E+00-1.84498805E-02
10  3 2.57037050E+00-3.61005769E-01 0.00000000E+00-8.04011024E-03 4.23981938E-02
10  4 0.00000000E+00 6.96620576E-01-1.68549392E+00 1.84498805E-02-2.57037050E+00
10  5 3.61005769E-01 0.00000000E+00-8.04011024E-03-4.23981938E-02 0.00000000E+00
10  6 6.96620576E-01 1.68549392E+00
11  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
11  2 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
11  3 0.00000000E+00 0.00000000E+00-4.58226713E-02 0.00000000E+00 0.00000000E+00
11  4 1.93899569E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
11  5 0.00000000E+00 4.58226713E-02 0.00000000E+00 0.00000000E+00-1.93899569E+00
11  6 0.00000000E+00 0.00000000E+00
12  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00 9.83113386E-03
12  2-0.00000000E+00-0.00000000E+00-5.51355245E-01-0.00000000E+00-1.60953249E-01
12  3 2.22969702E+01-1.91112480E+00-0.00000000E+00-5.69084828E-02-1.32008951E-02
12  4-0.00000000E+00 5.99205010E+00 7.59438524E-01 1.60953249E-01-2.22969702E+01
12  5 1.91112480E+00-0.00000000E+00-5.69084828E-02 1.32008951E-02-0.00000000E+00
12  6 5.99205010E+00-7.59438524E-01
13  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-2.20642492E-02-0.00000000E+00
13  2-0.00000000E+00 1.00841989E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
13  3-0.00000000E+00-0.00000000E+00-5.91653440E-03-0.00000000E+00-0.00000000E+00
13  4-4.95979114E-02-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
13  5-0.00000000E+00-5.91653440E-03-0.00000000E+00-0.00000000E+00-4.95979114E-02
13  6-0.00000000E+00-0.00000000E+00
14  1-3.31654665E-02-8.69621326E-02 3.01390043E-01-0.00000000E+00-0.00000000E+00
14  2-1.67154099E-02-0.00000000E+00-0.00000000E+00 8.99818685E-01-3.07158586E-01
14  3 2.83923744E-01-1.92632756E-01-0.00000000E+00-2.93306586E-03 1.73436908E-02
14  4-0.00000000E+00 3.02118486E-01 2.21224383E-01-3.07158586E-01 2.83923744E-01
14  5-1.92632756E-01-0.00000000E+00 2.93306586E-03 1.73436908E-02-0.00000000E+00
14  6-3.02118486E-01 2.21224383E-01
15  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00-1.34993665E-02
15  2 0.00000000E+00 0.00000000E+00 7.59770767E-01 0.00000000E+00-1.75191320E-01
15  3 2.08153974E+01-1.26943311E+00 0.00000000E+00-3.48644249E-02 6.69261311E-03
15  4 0.00000000E+00 5.56613954E+00-6.13660887E-01 1.75191320E-01-2.08153974E+01
15  5 1.26943311E+00 0.00000000E+00-3.48644249E-02-6.69261311E-03 0.00000000E+00
15  6 5.56613954E+00 6.13660887E-01
16  1 5.19344923E-04 8.87499453E-02-1.87950653E-01 0.00000000E+00 0.00000000E+00
16  2-3.56833630E-03 0.00000000E+00 0.00000000E+00-4.64544043E-01-7.73676137E-01
16  3 6.13129764E-01-1.27048546E-01 0.00000000E+00-2.06562182E-02-2.10932141E-02
16  4 0.00000000E+00 8.29062088E-01-9.07382515E-02-7.73676137E-01 6.13129764E-01
16  5-1.27048546E-01 0.00000000E+00 2.06562182E-02-2.10932141E-02 0.00000000E+00
16  6-8.29062088E-01-9.07382515E-02
17  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00 4.17389584E-03
17  2-0.00000000E+00-0.00000000E+00 8.84283467E-02-0.00000000E+00 9.16796009E-01
17  3 2.01749768E+01-3.18908752E-01-0.00000000E+00-4.87437785E-01-2.66670210E-03
17  4-0.00000000E+00 6.03869711E+00-2.58947535E-02-9.16796009E-01-2.01749768E+01
17  5 3.18908752E-01-0.00000000E+00-4.87437785E-01 2.66670210E-03-0.00000000E+00
17  6 6.03869711E+00 2.58947535E-02
18  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 8.50786542E-03 0.00000000E+00
18  2 0.00000000E+00 2.57860967E-02 0.00000000E+00 0.00000000E+00 0.00000000E+00
18  3 0.00000000E+00 0.00000000E+00 6.75843961E-01 0.00000000E+00 0.00000000E+00
18  4-2.93271455E-01 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
18  5 0.00000000E+00 6.75843961E-01 0.00000000E+00 0.00000000E+00-2.93271455E-01
18  6 0.00000000E+00 0.00000000E+00
19  1 2.66676848E-02 2.83764852E-02-1.87391543E-01 0.00000000E+00 0.00000000E+00
19  2-3.77133049E-02 0.00000000E+00 0.00000000E+00-1.49214224E-01-2.71987521E-02
19  3-1.09670551E-02 5.69644668E-02 0.00000000E+00 4.13605100E-03 6.83699545E-01
19  4 0.00000000E+00 5.89125747E-02-3.41347734E-01-2.71987521E-02-1.09670551E-02
19  5 5.69644668E-02 0.00000000E+00-4.13605100E-03 6.83699545E-01 0.00000000E+00
19  6-5.89125747E-02-3.41347734E-01
20  1-1.22608568E+00 1.71841519E+00-7.99222470E-01-0.00000000E+00-0.00000000E+00
20  2-1.50678260E-02-0.00000000E+00-0.00000000E+00-4.24028011E-02 4.21105977E-03
20  3-4.48176576E-03 6.83034629E-02-0.00000000E+00 1.23655036E-03 2.21953080E-02
20  4-0.00000000E+00 2.60025874E-04-5.46262726E-02 4.21105977E-03-4.48176576E-03
20  5 6.83034629E-02-0.00000000E+00-1.23655036E-03 2.21953080E-02-0.00000000E+00
20  6-2.60025874E-04-5.46262726E-02
21  1 1.11862489E-03 1.01203900E-03 3.72536314E-02 0.00000000E+00 0.00000000E+00
21  2-1.09783541E-02 0.00000000E+00 0.00000000E+00-5.67061025E-03-3.95165469E-01
21  3 3.88527930E-01-1.43052235E-01 0.00000000E+00 7.49385478E-01-8.03100285E-03
21  4 0.00000000E+00-4.35804882E-01 8.29422009E-03-3.95165469E-01 3.88527930E-01
21  5-1.43052235E-01 0.00000000E+00-7.49385478E-01-8.03100285E-03 0.00000000E+00
21  6 4.35804882E-01 8.29422009E-03
22  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
22  2-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
22  3-0.00000000E+00-0.00000000E+00 1.04482385E+00-0.00000000E+00-0.00000000E+00
22  4-6.95983102E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
22  5-0.00000000E+00-1.04482385E+00-0.00000000E+00-0.00000000E+00 6.95983102E-01
22  6-0.00000000E+00-0.00000000E+00
23  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 3.34830596E-02
23  2 0.00000000E+00 0.00000000E+00 2.97800862E-02 0.00000000E+00 5.67072098E-03
23  3 2.01945354E-01 5.76300721E-03 0.00000000E+00-2.45159253E-04 1.04471974E+00
23  4 0.00000000E+00 5.69088588E-02-7.04361586E-01-5.67072098E-03-2.01945354E-01
23  5-5.76300721E-03 0.00000000E+00-2.45159253E-04-1.04471974E+00 0.00000000E+00
23  6 5.69088588E-02 7.04361586E-01
24  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 1.13112795E+00 0.00000000E+00
24  2 0.00000000E+00-5.10041511E-01 0.00000000E+00 0.00000000E+00 0.00000000E+00
24  3 0.00000000E+00 0.00000000E+00-1.09714503E-02 0.00000000E+00 0.00000000E+00
24  4 1.33631917E-02 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
24  5 0.00000000E+00-1.09714503E-02 0.00000000E+00 0.00000000E+00 1.33631917E-02
24  6 0.00000000E+00 0.00000000E+00
25  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-1.13297398E+00
25  2-0.00000000E+00-0.00000000E+00 5.27061061E-01-0.00000000E+00 7.32387531E-02
25  3 1.30420266E+00 7.39981715E-02-0.00000000E+00 3.57620536E-02 4.76240018E-02
25  4-0.00000000E+00 3.61711320E-01-1.17672239E-01-7.32387531E-02-1.30420266E+00
25  5-7.39981715E-02-0.00000000E+00 3.57620536E-02-4.76240018E-02-0.00000000E+00
25  6 3.61711320E-01 1.17672239E-01
26  1-2.86900038E-02 7.89068880E-02-1.17459417E-01 0.00000000E+00 0.00000000E+00
26  2 1.13891895E+00 0.00000000E+00 0.00000000E+00-5.65040936E-01-5.05389429E-02
26  3 2.94354836E-02 3.26463529E-02 0.00000000E+00 9.70467101E-03 5.63045090E-02
26  4 0.00000000E+00 5.42317736E-02-8.16183914E-02-5.05389429E-02 2.94354836E-02
26  5 3.26463529E-02 0.00000000E+00-9.70467101E-03 5.63045090E-02 0.00000000E+00
26  6-5.42317736E-02-8.16183914E-02
27  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-3.42549375E-02
27  2-0.00000000E+00-0.00000000E+00 3.77982485E-02-0.00000000E+00-2.37181873E+00
27  3 7.47669692E+00-3.76190354E-01-0.00000000E+00-2.07582994E+00 3.17499773E-03
27  4-0.00000000E+00 2.11348077E+00-9.56760718E-03 2.37181873E+00-7.47669692E+00
27  5 3.76190354E-01-0.00000000E+00-2.07582994E+00-3.17499773E-03-0.00000000E+00
27  6 2.11348077E+00 9.56760718E-03
 $END   
'''
    heh2_ci = '''- - - NO-S OF CI STATE  1 E=       -4.0544723546 CREATEDSun May 11 14:57:32 2014
 $VEC   
 1  1 5.92711031E-01 4.95402514E-01 2.87757830E-02 0.00000000E+00 0.00000000E+00
 1  2 2.39902734E-05 0.00000000E+00 0.00000000E+00-5.20309572E-04 1.21873995E-03
 1  3 6.93189591E-04 3.35488030E-04 0.00000000E+00 1.27211746E-04 1.17900713E-04
 1  4 0.00000000E+00 7.61083376E-04-1.01968490E-03 1.21873995E-03 6.93189591E-04
 1  5 3.35488030E-04 0.00000000E+00-1.27211746E-04 1.17900713E-04 0.00000000E+00
 1  6-7.61083376E-04-1.01968490E-03
 2  1-8.41519064E-03-9.29810823E-03-1.15656082E-03-0.00000000E+00-0.00000000E+00
 2  2 2.81507929E-04-0.00000000E+00-0.00000000E+00 3.24712228E-04 4.07253776E-01
 2  3 1.70222340E-01 6.46290122E-03-0.00000000E+00 1.89534644E-02-9.53570869E-06
 2  4-0.00000000E+00 8.63894518E-04 1.11704147E-05 4.07253776E-01 1.70222340E-01
 2  5 6.46290122E-03-0.00000000E+00-1.89534644E-02-9.53570869E-06-0.00000000E+00
 2  6-8.63894518E-04 1.11704147E-05
 3  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-1.96970628E-04
 3  2-0.00000000E+00-0.00000000E+00 5.79886987E-04-0.00000000E+00 9.46886597E-01
 3  3 3.07721764E-01-3.28082493E-02-0.00000000E+00-2.58172250E-02 4.04548503E-06
 3  4-0.00000000E+00 1.40540957E-02-2.19082682E-04-9.46886597E-01-3.07721764E-01
 3  5 3.28082493E-02-0.00000000E+00-2.58172250E-02-4.04548503E-06-0.00000000E+00
 3  6 1.40540957E-02 2.19082682E-04
 4  1 1.13030509E+00-1.12971081E+00-3.95743152E-02 0.00000000E+00 0.00000000E+00
 4  2-1.76014969E-03 0.00000000E+00 0.00000000E+00 5.55856291E-03 6.31674441E-02
 4  3-5.57655463E-02-2.25343127E-03 0.00000000E+00 2.41953337E-02 1.03191130E-02
 4  4 0.00000000E+00-1.50214754E-02 1.12344917E-02 6.31674441E-02-5.57655463E-02
 4  5-2.25343127E-03 0.00000000E+00-2.41953337E-02 1.03191130E-02 0.00000000E+00
 4  6 1.50214754E-02 1.12344917E-02
 5  1 1.41456323E-01-1.64648125E-01-1.75851238E-02-0.00000000E+00-0.00000000E+00
 5  2 2.04095824E-02-0.00000000E+00-0.00000000E+00-1.24870161E-02-5.56256250E-01
 5  3 6.31129464E-01-2.81965690E-02-0.00000000E+00-2.60949076E-01 5.66193495E-03
 5  4-0.00000000E+00 1.19103546E-01 5.25320835E-07-5.56256250E-01 6.31129464E-01
 5  5-2.81965690E-02-0.00000000E+00 2.60949076E-01 5.66193495E-03-0.00000000E+00
 5  6-1.19103546E-01 5.25320835E-07
 6  1-5.27185817E-02 5.78952546E-02 4.17641091E-02-0.00000000E+00-0.00000000E+00
 6  2-1.53209871E-02-0.00000000E+00-0.00000000E+00 1.93539981E-02 6.21108067E-03
 6  3-6.60562955E-04-1.14204415E-02-0.00000000E+00 2.69897297E-03 4.61938367E-01
 6  4-0.00000000E+00-1.03916491E-02 1.75262520E-01 6.21108067E-03-6.60562955E-04
 6  5-1.14204415E-02-0.00000000E+00-2.69897297E-03 4.61938367E-01-0.00000000E+00
 6  6 1.03916491E-02 1.75262520E-01
 7  1-0.00000000E+00-0.00000000E+00-0.00000000E+00 1.59311021E-03-0.00000000E+00
 7  2-0.00000000E+00-3.68478164E-03-0.00000000E+00-0.00000000E+00-0.00000000E+00
 7  3-0.00000000E+00-0.00000000E+00 4.65898727E-01-0.00000000E+00-0.00000000E+00
 7  4 1.67223792E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
 7  5-0.00000000E+00 4.65898727E-01-0.00000000E+00-0.00000000E+00 1.67223792E-01
 7  6-0.00000000E+00-0.00000000E+00
 8  1-1.93954695E-03-3.76572930E-03 1.90700520E-02-0.00000000E+00-0.00000000E+00
 8  2 8.39492539E-01-0.00000000E+00-0.00000000E+00 2.82192126E-01 2.42376778E-02
 8  3-3.00896435E-02-5.96947984E-03-0.00000000E+00 1.12169339E-02 6.41738359E-03
 8  4-0.00000000E+00-1.37294600E-02 1.52708006E-02 2.42376778E-02-3.00896435E-02
 8  5-5.96947984E-03-0.00000000E+00-1.12169339E-02 6.41738359E-03-0.00000000E+00
 8  6 1.37294600E-02 1.52708006E-02
 9  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 8.43531406E-01
 9  2 0.00000000E+00 0.00000000E+00 2.73251730E-01 0.00000000E+00 2.13112504E-03
 9  3 2.12234567E-01 1.82219729E-02 0.00000000E+00-2.32424245E-03 1.98625504E-03
 9  4 0.00000000E+00 5.84631970E-02-1.51382056E-02-2.13112504E-03-2.12234567E-01
 9  5-1.82219729E-02 0.00000000E+00-2.32424245E-03-1.98625504E-03 0.00000000E+00
 9  6 5.84631970E-02 1.51382056E-02
10  1-0.00000000E+00-0.00000000E+00-0.00000000E+00 8.44989297E-01-0.00000000E+00
10  2-0.00000000E+00 2.69904435E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00
10  3-0.00000000E+00-0.00000000E+00-1.57485023E-04-0.00000000E+00-0.00000000E+00
10  4-2.06691761E-03-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
10  5-0.00000000E+00-1.57485023E-04-0.00000000E+00-0.00000000E+00-2.06691761E-03
10  6-0.00000000E+00-0.00000000E+00
11  1-2.35386892E-02 3.64032463E-02 4.55589223E-03 0.00000000E+00 0.00000000E+00
11  2 1.96121038E-02 0.00000000E+00 0.00000000E+00 7.48995567E-03 7.07760642E-01
11  3-4.62864870E-01 5.98957127E-02 0.00000000E+00-6.21196775E-01-7.59521418E-03
11  4 0.00000000E+00-2.89475060E-01 9.49109175E-03 7.07760642E-01-4.62864870E-01
11  5 5.98957127E-02 0.00000000E+00 6.21196775E-01-7.59521418E-03 0.00000000E+00
11  6 2.89475060E-01 9.49109175E-03
12  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-1.37280680E-02
12  2-0.00000000E+00-0.00000000E+00 2.58489289E-02-0.00000000E+00 1.82677481E+00
12  3 5.82995257E+00 2.40664219E-01-0.00000000E+00 8.79628935E-01 4.88380873E-02
12  4-0.00000000E+00 2.15729637E+00 2.60497688E-02-1.82677481E+00-5.82995257E+00
12  5-2.40664219E-01-0.00000000E+00 8.79628935E-01-4.88380873E-02-0.00000000E+00
12  6 2.15729637E+00-2.60497688E-02
13  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00-4.58950595E-03
13  2 0.00000000E+00 0.00000000E+00 1.93097845E-03 0.00000000E+00-1.09768375E-01
13  3-4.60474276E-01-9.71627516E-03 0.00000000E+00-5.53856571E-02 9.26514901E-01
13  4 0.00000000E+00-1.55899135E-01 1.86253688E-01 1.09768375E-01 4.60474276E-01
13  5 9.71627516E-03 0.00000000E+00-5.53856571E-02-9.26514901E-01 0.00000000E+00
13  6-1.55899135E-01-1.86253688E-01
14  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
14  2-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
14  3-0.00000000E+00-0.00000000E+00 9.31343959E-01-0.00000000E+00-0.00000000E+00
14  4 1.72510829E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
14  5-0.00000000E+00-9.31343959E-01-0.00000000E+00-0.00000000E+00-1.72510829E-01
14  6-0.00000000E+00-0.00000000E+00
15  1 5.52446163E-02-1.04041557E-01-7.16144415E-03 0.00000000E+00 0.00000000E+00
15  2-4.70208333E-01 0.00000000E+00 0.00000000E+00 6.18009386E-01 5.17407901E-02
15  3-7.03791015E-02 8.61639800E-03 0.00000000E+00-3.14255351E-02 3.66504572E-01
15  4 0.00000000E+00 2.98831945E-02-4.08299412E-01 5.17407901E-02-7.03791015E-02
15  5 8.61639800E-03 0.00000000E+00 3.14255351E-02 3.66504572E-01 0.00000000E+00
15  6-2.98831945E-02-4.08299412E-01
16  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-1.88887001E-01-0.00000000E+00
16  2-0.00000000E+00 2.61002001E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00
16  3-0.00000000E+00-0.00000000E+00-4.71762336E-01-0.00000000E+00-0.00000000E+00
16  4 5.53311047E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
16  5-0.00000000E+00-4.71762336E-01-0.00000000E+00-0.00000000E+00 5.53311047E-01
16  6-0.00000000E+00-0.00000000E+00
17  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-7.54577146E-01
17  2-0.00000000E+00-0.00000000E+00 1.10432659E+00-0.00000000E+00-4.48870453E-02
17  3 4.05046906E-01 1.01734228E-01-0.00000000E+00-4.36729538E-02-1.26113747E-02
17  4-0.00000000E+00 1.10206062E-01-1.80609237E-02 4.48870453E-02-4.05046906E-01
17  5-1.01734228E-01-0.00000000E+00-4.36729538E-02 1.26113747E-02-0.00000000E+00
17  6 1.10206062E-01 1.80609237E-02
18  1-6.37639079E-02 1.12584049E-01 3.95938646E-02 0.00000000E+00 0.00000000E+00
18  2-6.06827133E-01 0.00000000E+00 0.00000000E+00 9.67845810E-01 7.41799348E-02
18  3-3.26084393E-02-3.54272159E-02 0.00000000E+00 1.04584270E-02-3.39155643E-01
18  4 0.00000000E+00-1.53513496E-01 4.41183008E-01 7.41799348E-02-3.26084393E-02
18  5-3.54272159E-02 0.00000000E+00-1.04584270E-02-3.39155643E-01 0.00000000E+00
18  6 1.53513496E-01 4.41183008E-01
19  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-7.28239169E-01-0.00000000E+00
19  2-0.00000000E+00 1.06822963E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
19  3-0.00000000E+00-0.00000000E+00 1.32111131E-01-0.00000000E+00-0.00000000E+00
19  4-1.62074348E-01-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00
19  5-0.00000000E+00 1.32111131E-01-0.00000000E+00-0.00000000E+00-1.62074348E-01
19  6-0.00000000E+00-0.00000000E+00
20  1 3.72051629E-01-1.13984599E+00 1.29766701E+00 0.00000000E+00 0.00000000E+00
20  2-3.44406638E-02 0.00000000E+00 0.00000000E+00 9.18959564E-02 1.46794432E-01
20  3 1.05040726E-02-5.62450871E-04 0.00000000E+00 1.71000776E-01-4.50884370E-02
20  4 0.00000000E+00-8.70481417E-01 1.32646274E-01 1.46794432E-01 1.05040726E-02
20  5-5.62450871E-04 0.00000000E+00-1.71000776E-01-4.50884370E-02 0.00000000E+00
20  6 8.70481417E-01 1.32646274E-01
21  1 2.88971229E-01-9.05487880E-01 1.11443242E+00 0.00000000E+00 0.00000000E+00
21  2-4.95503059E-02 0.00000000E+00 0.00000000E+00 1.10577144E-01-6.97243132E-02
21  3-1.57717229E-01-1.92179100E-01 0.00000000E+00-2.35215694E-01-8.10747065E-02
21  4 0.00000000E+00 1.04098709E+00 1.66264293E-01-6.97243132E-02-1.57717229E-01
21  5-1.92179100E-01 0.00000000E+00 2.35215694E-01-8.10747065E-02 0.00000000E+00
21  6-1.04098709E+00 1.66264293E-01
22  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 1.83057709E-02
22  2 0.00000000E+00 0.00000000E+00-3.06902148E-02 0.00000000E+00-1.49205442E+00
22  3 4.82617193E+00 4.05381702E-03 0.00000000E+00-1.81261815E+00-6.65402003E-02
22  4 0.00000000E+00 1.80124452E+00 2.66587599E-01 1.49205442E+00-4.82617193E+00
22  5-4.05381702E-03 0.00000000E+00-1.81261815E+00 6.65402003E-02 0.00000000E+00
22  6 1.80124452E+00-2.66587599E-01
23  1-0.00000000E+00-0.00000000E+00-0.00000000E+00-0.00000000E+00-6.04949354E-02
23  2-0.00000000E+00-0.00000000E+00 1.58489901E-01-0.00000000E+00-2.34275671E-01
23  3 1.02656499E+01-1.84761617E-01-0.00000000E+00-4.03221468E-01 4.63454633E-01
23  4-0.00000000E+00 2.87607889E+00-1.97575778E+00 2.34275671E-01-1.02656499E+01
23  5 1.84761617E-01-0.00000000E+00-4.03221468E-01-4.63454633E-01-0.00000000E+00
23  6 2.87607889E+00 1.97575778E+00
24  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
24  2 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
24  3 0.00000000E+00 0.00000000E+00-4.75767822E-01 0.00000000E+00 0.00000000E+00
24  4 2.05288499E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00
24  5 0.00000000E+00 4.75767822E-01 0.00000000E+00 0.00000000E+00-2.05288499E+00
24  6 0.00000000E+00 0.00000000E+00
25  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00-3.34877294E-02
25  2 0.00000000E+00 0.00000000E+00 1.12462055E-01 0.00000000E+00-1.66795665E-01
25  3 3.27052074E+01-7.20950252E-01 0.00000000E+00-5.64030472E-01-1.24678369E-01
25  4 0.00000000E+00 8.93468239E+00 5.42508289E-01 1.66795665E-01-3.27052074E+01
25  5 7.20950252E-01 0.00000000E+00-5.64030472E-01 1.24678369E-01 0.00000000E+00
25  6 8.93468239E+00-5.42508289E-01
26  1 9.09321173E-03-9.32343885E-02 4.89575122E-01 0.00000000E+00 0.00000000E+00
26  2-2.24669738E-02 0.00000000E+00 0.00000000E+00 1.00267581E-01-1.96020215E-01
26  3 9.10531496E-01-9.02949801E-01 0.00000000E+00 1.49478859E-01-2.22425380E-02
26  4 0.00000000E+00-7.92281602E-01 6.25957938E-02-1.96020215E-01 9.10531496E-01
26  5-9.02949801E-01 0.00000000E+00-1.49478859E-01-2.22425380E-02 0.00000000E+00
26  6 7.92281602E-01 6.25957938E-02
27  1 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 1.02458011E-02
27  2 0.00000000E+00 0.00000000E+00-4.41434205E-02 0.00000000E+00-4.64447364E-02
27  3 1.65539571E+01-5.80132034E+00 0.00000000E+00-9.16587474E-02-8.60624083E-04
27  4 0.00000000E+00 4.13819582E+00 6.10347643E-03 4.64447364E-02-1.65539571E+01
27  5 5.80132034E+00 0.00000000E+00-9.16587474E-02 8.60624083E-04 0.00000000E+00
27  6 4.13819582E+00-6.10347643E-03
 $END   
 POPULATION ANALYSIS
HE           1.99940   0.00060   1.99543   0.00457
H            1.00030  -0.00030   1.00228  -0.00228
H            1.00030  -0.00030   1.00228  -0.00228
 MOMENTS AT POINT    1 X,Y,Z= -0.000000  0.000000 -0.990462
 DIPOLE       0.000000 -0.000000 -0.002284'''

    def setUp(self):
        dat = os.path.join(os.path.abspath(os.path.dirname(__file__)), 'data/heh2/he-h2_avdz_ormas.dat')
        self.gdp = GamessDatParser(dat)

    def test_get_occupations(self):
        occ = np.asarray([1.9834456915, 1.9627294361, 0.0219011137, 0.0086270134, 0.0058604713,
                          0.0043010033, 0.0042744336, 0.0025955687, 0.0025860263, 0.0025813892,
                          0.0002213068, 0.0001793303, 0.0001611995, 0.0001604803, 0.0000737114,
                          0.0000629726, 0.0000589416, 0.0000584937, 0.0000565345, 0.0000238999,
                          0.0000209238, 0.0000119612, 0.0000045282, 0.0000026636, 0.0000004760,
                          0.0000004253, 0.0000000042])
        self.assertTrue(np.allclose(occ, self.gdp.get_occupations(), rtol=1.0e-10, atol=1.0e-10))

    def test_get_naos_nmos_hf(self):
        t = (27, 27, 6)
        vecstr = re.search(r'\$VEC\s*\n(.*?)\s*\$END', TestGDPonHeH2.heh2_rhf, flags=re.DOTALL).group(1)
        self.assertTupleEqual(t, get_naos_nmos(vecstr))

    def test_get_naos_nmos_ci(self):
        t = (27, 27, 6)
        vecstr = re.search(r'\$VEC\s*\n(.*?)\s*\$END', TestGDPonHeH2.heh2_ci, flags=re.DOTALL).group(1)
        self.assertTupleEqual(t, get_naos_nmos(vecstr))

    def test_parse_orbitals_hf(self):
        rhf =np.asarray([[  5.94341142e-01,  -9.00596442e-03,  -0.00000000e+00,
         -3.05234025e-02,  -1.41697620e-01,  -0.00000000e+00,
         -0.00000000e+00,  -3.42587258e-02,  -3.62319168e-03,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -3.31654665e-02,   0.00000000e+00,
          5.19344923e-04,  -0.00000000e+00,   0.00000000e+00,
          2.66676848e-02,  -1.22608568e+00,   1.11862489e-03,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,  -2.86900038e-02,  -0.00000000e+00],
       [  4.96648283e-01,  -9.92166094e-03,  -0.00000000e+00,
         -4.06841135e-02,  -6.29282968e-01,  -0.00000000e+00,
         -0.00000000e+00,  -2.91087042e-01,   1.85029027e-02,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -8.69621326e-02,   0.00000000e+00,
          8.87499453e-02,  -0.00000000e+00,   0.00000000e+00,
          2.83764852e-02,   1.71841519e+00,   1.01203900e-03,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   7.89068880e-02,  -0.00000000e+00],
       [  2.38093259e-02,  -1.37947380e-03,  -0.00000000e+00,
         -1.74220090e-01,   1.34588277e+00,  -0.00000000e+00,
         -0.00000000e+00,   6.94407086e-01,  -1.79706205e-01,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   3.01390043e-01,   0.00000000e+00,
         -1.87950653e-01,  -0.00000000e+00,   0.00000000e+00,
         -1.87391543e-01,  -7.99222470e-01,   3.72536314e-02,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,  -1.17459417e-01,  -0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -3.22124256e-03,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -2.20642492e-02,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   8.50786542e-03,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,   1.13112795e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -1.94514726e-03,
         -0.00000000e+00,   0.00000000e+00,   7.31317589e-04,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
          1.17233606e-02,   0.00000000e+00,   9.83113386e-03,
         -0.00000000e+00,  -0.00000000e+00,  -1.34993665e-02,
          0.00000000e+00,   4.17389584e-03,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   3.34830596e-02,   0.00000000e+00,
         -1.13297398e+00,   0.00000000e+00,  -3.42549375e-02],
       [  3.65054986e-05,   3.15442232e-04,  -0.00000000e+00,
          4.34466234e-03,  -1.52618951e-04,  -0.00000000e+00,
         -0.00000000e+00,   6.50957355e-03,   2.87643500e-03,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -1.67154099e-02,   0.00000000e+00,
         -3.56833630e-03,  -0.00000000e+00,   0.00000000e+00,
         -3.77133049e-02,  -1.50678260e-02,  -1.09783541e-02,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   1.13891895e+00,  -0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
          6.61863580e-02,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
          1.00841989e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   2.57860967e-02,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -5.10041511e-01,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -3.25528355e-03,
         -0.00000000e+00,   0.00000000e+00,  -1.59082394e-02,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -4.07549826e-01,   0.00000000e+00,  -5.51355245e-01,
         -0.00000000e+00,  -0.00000000e+00,   7.59770767e-01,
          0.00000000e+00,   8.84283467e-02,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   2.97800862e-02,   0.00000000e+00,
          5.27061061e-01,   0.00000000e+00,   3.77982485e-02],
       [ -6.20897336e-04,   1.55898519e-04,  -0.00000000e+00,
         -2.38819857e-02,   6.90874107e-03,  -0.00000000e+00,
         -0.00000000e+00,  -2.45083253e-01,  -1.05699070e-02,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   8.99818685e-01,   0.00000000e+00,
         -4.64544043e-01,  -0.00000000e+00,   0.00000000e+00,
         -1.49214224e-01,  -4.24028011e-02,  -5.67061025e-03,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,  -5.65040936e-01,  -0.00000000e+00],
       [  1.66217257e-03,   4.01361080e-01,   5.00775117e-02,
         -6.08577947e-02,  -9.82085055e-03,   1.67263691e-01,
         -0.00000000e+00,   3.08611088e-02,   1.88675933e-01,
         -1.84498805e-02,   0.00000000e+00,  -1.60953249e-01,
         -0.00000000e+00,  -3.07158586e-01,  -1.75191320e-01,
         -7.73676137e-01,   9.16796009e-01,   0.00000000e+00,
         -2.71987521e-02,   4.21105977e-03,  -3.95165469e-01,
         -0.00000000e+00,   5.67072098e-03,   0.00000000e+00,
          7.32387531e-02,  -5.05389429e-02,  -2.37181873e+00],
       [  8.99199084e-04,   1.73534106e-01,  -2.16848536e+00,
         -3.75435126e-01,   6.52718216e-02,   1.00213063e+01,
         -0.00000000e+00,  -3.10008034e-02,  -8.49022834e-01,
          2.57037050e+00,   0.00000000e+00,   2.22969702e+01,
         -0.00000000e+00,   2.83923744e-01,   2.08153974e+01,
          6.13129764e-01,   2.01749768e+01,   0.00000000e+00,
         -1.09670551e-02,  -4.48176576e-03,   3.88527930e-01,
         -0.00000000e+00,   2.01945354e-01,   0.00000000e+00,
          1.30420266e+00,   2.94354836e-02,   7.47669692e+00],
       [  5.58556722e-04,   7.17373295e-03,   4.32699827e+00,
          7.36067528e-01,  -2.03640543e-01,  -3.14852088e+00,
         -0.00000000e+00,  -1.01684006e-01,   4.26416839e-01,
         -3.61005769e-01,   0.00000000e+00,  -1.91112480e+00,
         -0.00000000e+00,  -1.92632756e-01,  -1.26943311e+00,
         -1.27048546e-01,  -3.18908752e-01,   0.00000000e+00,
          5.69644668e-02,   6.83034629e-02,  -1.43052235e-01,
         -0.00000000e+00,   5.76300721e-03,   0.00000000e+00,
          7.39981715e-02,   3.26463529e-02,  -3.76190354e-01],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -1.24202650e-02,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -4.58226713e-02,  -0.00000000e+00,
         -5.91653440e-03,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   6.75843961e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          1.04482385e+00,   0.00000000e+00,  -1.09714503e-02,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [  1.63595833e-04,   2.16962306e-02,  -1.83746968e-03,
         -1.31356432e-02,   1.62613155e-03,  -4.03863045e-02,
         -0.00000000e+00,  -1.20233571e-03,  -1.70909112e-02,
         -8.04011024e-03,   0.00000000e+00,  -5.69084828e-02,
         -0.00000000e+00,  -2.93306586e-03,  -3.48644249e-02,
         -2.06562182e-02,  -4.87437785e-01,   0.00000000e+00,
          4.13605100e-03,   1.23655036e-03,   7.49385478e-01,
         -0.00000000e+00,  -2.45159253e-04,   0.00000000e+00,
          3.57620536e-02,   9.70467101e-03,  -2.07582994e+00],
       [  1.37021945e-04,  -9.72101523e-07,   5.39647224e-05,
          5.14638178e-04,  -3.71799345e-03,   1.19245387e-04,
         -0.00000000e+00,  -1.20374379e-02,  -5.55314816e-04,
          4.23981938e-02,   0.00000000e+00,  -1.32008951e-02,
         -0.00000000e+00,   1.73436908e-02,   6.69261311e-03,
         -2.10932141e-02,  -2.66670210e-03,   0.00000000e+00,
          6.83699545e-01,   2.21953080e-02,  -8.03100285e-03,
         -0.00000000e+00,   1.04471974e+00,   0.00000000e+00,
          4.76240018e-02,   5.63045090e-02,   3.17499773e-03],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
          5.21289366e-01,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   1.93899569e+00,  -0.00000000e+00,
         -4.95979114e-02,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -2.93271455e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -6.95983102e-01,   0.00000000e+00,   1.33631917e-02,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [  7.68100142e-04,   5.09681092e-03,  -5.43254135e-01,
          7.12105764e-02,  -5.59572047e-02,   2.10470950e+00,
         -0.00000000e+00,   6.73882805e-02,   1.26662516e+00,
          6.96620576e-01,   0.00000000e+00,   5.99205010e+00,
         -0.00000000e+00,   3.02118486e-01,   5.56613954e+00,
          8.29062088e-01,   6.03869711e+00,   0.00000000e+00,
          5.89125747e-02,   2.60025874e-04,  -4.35804882e-01,
         -0.00000000e+00,   5.69088588e-02,   0.00000000e+00,
          3.61711320e-01,   5.42317736e-02,   2.11348077e+00],
       [ -1.10039928e-03,   6.26271405e-06,  -1.07581522e-03,
          6.75460460e-03,  -1.02909580e-01,  -3.62726158e-03,
         -0.00000000e+00,   4.93621562e-01,  -6.30050635e-02,
         -1.68549392e+00,   0.00000000e+00,   7.59438524e-01,
         -0.00000000e+00,   2.21224383e-01,  -6.13660887e-01,
         -9.07382515e-02,  -2.58947535e-02,   0.00000000e+00,
         -3.41347734e-01,  -5.46262726e-02,   8.29422009e-03,
         -0.00000000e+00,  -7.04361586e-01,   0.00000000e+00,
         -1.17672239e-01,  -8.16183914e-02,  -9.56760718e-03],
       [  1.66217257e-03,   4.01361080e-01,  -5.00775117e-02,
         -6.08577947e-02,  -9.82085055e-03,  -1.67263691e-01,
         -0.00000000e+00,   3.08611088e-02,   1.88675933e-01,
          1.84498805e-02,   0.00000000e+00,   1.60953249e-01,
         -0.00000000e+00,  -3.07158586e-01,   1.75191320e-01,
         -7.73676137e-01,  -9.16796009e-01,   0.00000000e+00,
         -2.71987521e-02,   4.21105977e-03,  -3.95165469e-01,
         -0.00000000e+00,  -5.67072098e-03,   0.00000000e+00,
         -7.32387531e-02,  -5.05389429e-02,   2.37181873e+00],
       [  8.99199084e-04,   1.73534106e-01,   2.16848536e+00,
         -3.75435126e-01,   6.52718216e-02,  -1.00213063e+01,
         -0.00000000e+00,  -3.10008034e-02,  -8.49022834e-01,
         -2.57037050e+00,   0.00000000e+00,  -2.22969702e+01,
         -0.00000000e+00,   2.83923744e-01,  -2.08153974e+01,
          6.13129764e-01,  -2.01749768e+01,   0.00000000e+00,
         -1.09670551e-02,  -4.48176576e-03,   3.88527930e-01,
         -0.00000000e+00,  -2.01945354e-01,   0.00000000e+00,
         -1.30420266e+00,   2.94354836e-02,  -7.47669692e+00],
       [  5.58556722e-04,   7.17373295e-03,  -4.32699827e+00,
          7.36067528e-01,  -2.03640543e-01,   3.14852088e+00,
         -0.00000000e+00,  -1.01684006e-01,   4.26416839e-01,
          3.61005769e-01,   0.00000000e+00,   1.91112480e+00,
         -0.00000000e+00,  -1.92632756e-01,   1.26943311e+00,
         -1.27048546e-01,   3.18908752e-01,   0.00000000e+00,
          5.69644668e-02,   6.83034629e-02,  -1.43052235e-01,
         -0.00000000e+00,  -5.76300721e-03,   0.00000000e+00,
         -7.39981715e-02,   3.26463529e-02,   3.76190354e-01],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
         -1.24202650e-02,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   4.58226713e-02,  -0.00000000e+00,
         -5.91653440e-03,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   6.75843961e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -1.04482385e+00,   0.00000000e+00,  -1.09714503e-02,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [ -1.63595833e-04,  -2.16962306e-02,  -1.83746968e-03,
          1.31356432e-02,  -1.62613155e-03,  -4.03863045e-02,
         -0.00000000e+00,   1.20233571e-03,   1.70909112e-02,
         -8.04011024e-03,   0.00000000e+00,  -5.69084828e-02,
         -0.00000000e+00,   2.93306586e-03,  -3.48644249e-02,
          2.06562182e-02,  -4.87437785e-01,   0.00000000e+00,
         -4.13605100e-03,  -1.23655036e-03,  -7.49385478e-01,
         -0.00000000e+00,  -2.45159253e-04,   0.00000000e+00,
          3.57620536e-02,  -9.70467101e-03,  -2.07582994e+00],
       [  1.37021945e-04,  -9.72101523e-07,  -5.39647224e-05,
          5.14638178e-04,  -3.71799345e-03,  -1.19245387e-04,
         -0.00000000e+00,  -1.20374379e-02,  -5.55314816e-04,
         -4.23981938e-02,   0.00000000e+00,   1.32008951e-02,
         -0.00000000e+00,   1.73436908e-02,  -6.69261311e-03,
         -2.10932141e-02,   2.66670210e-03,   0.00000000e+00,
          6.83699545e-01,   2.21953080e-02,  -8.03100285e-03,
         -0.00000000e+00,  -1.04471974e+00,   0.00000000e+00,
         -4.76240018e-02,   5.63045090e-02,  -3.17499773e-03],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00,
          5.21289366e-01,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -1.93899569e+00,  -0.00000000e+00,
         -4.95979114e-02,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -2.93271455e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          6.95983102e-01,   0.00000000e+00,   1.33631917e-02,
         -0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [ -7.68100142e-04,  -5.09681092e-03,  -5.43254135e-01,
         -7.12105764e-02,   5.59572047e-02,   2.10470950e+00,
         -0.00000000e+00,  -6.73882805e-02,  -1.26662516e+00,
          6.96620576e-01,   0.00000000e+00,   5.99205010e+00,
         -0.00000000e+00,  -3.02118486e-01,   5.56613954e+00,
         -8.29062088e-01,   6.03869711e+00,   0.00000000e+00,
         -5.89125747e-02,  -2.60025874e-04,   4.35804882e-01,
         -0.00000000e+00,   5.69088588e-02,   0.00000000e+00,
          3.61711320e-01,  -5.42317736e-02,   2.11348077e+00],
       [ -1.10039928e-03,   6.26271405e-06,   1.07581522e-03,
          6.75460460e-03,  -1.02909580e-01,   3.62726158e-03,
         -0.00000000e+00,   4.93621562e-01,  -6.30050635e-02,
          1.68549392e+00,   0.00000000e+00,  -7.59438524e-01,
         -0.00000000e+00,   2.21224383e-01,   6.13660887e-01,
         -9.07382515e-02,   2.58947535e-02,   0.00000000e+00,
         -3.41347734e-01,  -5.46262726e-02,   8.29422009e-03,
         -0.00000000e+00,   7.04361586e-01,   0.00000000e+00,
          1.17672239e-01,  -8.16183914e-02,   9.56760718e-03]], dtype=float)

        self.assertTrue(np.allclose(rhf, self.gdp.get_orbitals('hf'), rtol=1.0e-10, atol=1.0e-10))

    def test_parse_orbitals_ci(self):
        cino = np.asarray([[  5.92711031e-01,  -8.41519064e-03,  -0.00000000e+00,
          1.13030509e+00,   1.41456323e-01,  -5.27185817e-02,
         -0.00000000e+00,  -1.93954695e-03,   0.00000000e+00,
         -0.00000000e+00,  -2.35386892e-02,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   5.52446163e-02,
         -0.00000000e+00,  -0.00000000e+00,  -6.37639079e-02,
         -0.00000000e+00,   3.72051629e-01,   2.88971229e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   9.09321173e-03,   0.00000000e+00],
       [  4.95402514e-01,  -9.29810823e-03,  -0.00000000e+00,
         -1.12971081e+00,  -1.64648125e-01,   5.78952546e-02,
         -0.00000000e+00,  -3.76572930e-03,   0.00000000e+00,
         -0.00000000e+00,   3.64032463e-02,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -1.04041557e-01,
         -0.00000000e+00,  -0.00000000e+00,   1.12584049e-01,
         -0.00000000e+00,  -1.13984599e+00,  -9.05487880e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -9.32343885e-02,   0.00000000e+00],
       [  2.87757830e-02,  -1.15656082e-03,  -0.00000000e+00,
         -3.95743152e-02,  -1.75851238e-02,   4.17641091e-02,
         -0.00000000e+00,   1.90700520e-02,   0.00000000e+00,
         -0.00000000e+00,   4.55589223e-03,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -7.16144415e-03,
         -0.00000000e+00,  -0.00000000e+00,   3.95938646e-02,
         -0.00000000e+00,   1.29766701e+00,   1.11443242e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   4.89575122e-01,   0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          1.59311021e-03,  -0.00000000e+00,   0.00000000e+00,
          8.44989297e-01,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
         -1.88887001e-01,  -0.00000000e+00,   0.00000000e+00,
         -7.28239169e-01,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -1.96970628e-04,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,   8.43531406e-01,
         -0.00000000e+00,   0.00000000e+00,  -1.37280680e-02,
         -4.58950595e-03,  -0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,  -7.54577146e-01,   0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          1.83057709e-02,  -6.04949354e-02,   0.00000000e+00,
         -3.34877294e-02,   0.00000000e+00,   1.02458011e-02],
       [  2.39902734e-05,   2.81507929e-04,  -0.00000000e+00,
         -1.76014969e-03,   2.04095824e-02,  -1.53209871e-02,
         -0.00000000e+00,   8.39492539e-01,   0.00000000e+00,
         -0.00000000e+00,   1.96121038e-02,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -4.70208333e-01,
         -0.00000000e+00,  -0.00000000e+00,  -6.06827133e-01,
         -0.00000000e+00,  -3.44406638e-02,  -4.95503059e-02,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -2.24669738e-02,   0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -3.68478164e-03,  -0.00000000e+00,   0.00000000e+00,
          2.69904435e-01,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          2.61002001e-01,  -0.00000000e+00,   0.00000000e+00,
          1.06822963e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,  -0.00000000e+00,   5.79886987e-04,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,   2.73251730e-01,
         -0.00000000e+00,   0.00000000e+00,   2.58489289e-02,
          1.93097845e-03,  -0.00000000e+00,   0.00000000e+00,
         -0.00000000e+00,   1.10432659e+00,   0.00000000e+00,
         -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         -3.06902148e-02,   1.58489901e-01,   0.00000000e+00,
          1.12462055e-01,   0.00000000e+00,  -4.41434205e-02],
       [ -5.20309572e-04,   3.24712228e-04,  -0.00000000e+00,
          5.55856291e-03,  -1.24870161e-02,   1.93539981e-02,
         -0.00000000e+00,   2.82192126e-01,   0.00000000e+00,
         -0.00000000e+00,   7.48995567e-03,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   6.18009386e-01,
         -0.00000000e+00,  -0.00000000e+00,   9.67845810e-01,
         -0.00000000e+00,   9.18959564e-02,   1.10577144e-01,
          0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   1.00267581e-01,   0.00000000e+00],
       [  1.21873995e-03,   4.07253776e-01,   9.46886597e-01,
          6.31674441e-02,  -5.56256250e-01,   6.21108067e-03,
         -0.00000000e+00,   2.42376778e-02,   2.13112504e-03,
         -0.00000000e+00,   7.07760642e-01,   1.82677481e+00,
         -1.09768375e-01,  -0.00000000e+00,   5.17407901e-02,
         -0.00000000e+00,  -4.48870453e-02,   7.41799348e-02,
         -0.00000000e+00,   1.46794432e-01,  -6.97243132e-02,
         -1.49205442e+00,  -2.34275671e-01,   0.00000000e+00,
         -1.66795665e-01,  -1.96020215e-01,  -4.64447364e-02],
       [  6.93189591e-04,   1.70222340e-01,   3.07721764e-01,
         -5.57655463e-02,   6.31129464e-01,  -6.60562955e-04,
         -0.00000000e+00,  -3.00896435e-02,   2.12234567e-01,
         -0.00000000e+00,  -4.62864870e-01,   5.82995257e+00,
         -4.60474276e-01,  -0.00000000e+00,  -7.03791015e-02,
         -0.00000000e+00,   4.05046906e-01,  -3.26084393e-02,
         -0.00000000e+00,   1.05040726e-02,  -1.57717229e-01,
          4.82617193e+00,   1.02656499e+01,   0.00000000e+00,
          3.27052074e+01,   9.10531496e-01,   1.65539571e+01],
       [  3.35488030e-04,   6.46290122e-03,  -3.28082493e-02,
         -2.25343127e-03,  -2.81965690e-02,  -1.14204415e-02,
         -0.00000000e+00,  -5.96947984e-03,   1.82219729e-02,
         -0.00000000e+00,   5.98957127e-02,   2.40664219e-01,
         -9.71627516e-03,  -0.00000000e+00,   8.61639800e-03,
         -0.00000000e+00,   1.01734228e-01,  -3.54272159e-02,
         -0.00000000e+00,  -5.62450871e-04,  -1.92179100e-01,
          4.05381702e-03,  -1.84761617e-01,   0.00000000e+00,
         -7.20950252e-01,  -9.02949801e-01,  -5.80132034e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          4.65898727e-01,  -0.00000000e+00,   0.00000000e+00,
         -1.57485023e-04,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   9.31343959e-01,   0.00000000e+00,
         -4.71762336e-01,  -0.00000000e+00,   0.00000000e+00,
          1.32111131e-01,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -4.75767822e-01,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  1.27211746e-04,   1.89534644e-02,  -2.58172250e-02,
          2.41953337e-02,  -2.60949076e-01,   2.69897297e-03,
         -0.00000000e+00,   1.12169339e-02,  -2.32424245e-03,
         -0.00000000e+00,  -6.21196775e-01,   8.79628935e-01,
         -5.53856571e-02,  -0.00000000e+00,  -3.14255351e-02,
         -0.00000000e+00,  -4.36729538e-02,   1.04584270e-02,
         -0.00000000e+00,   1.71000776e-01,  -2.35215694e-01,
         -1.81261815e+00,  -4.03221468e-01,   0.00000000e+00,
         -5.64030472e-01,   1.49478859e-01,  -9.16587474e-02],
       [  1.17900713e-04,  -9.53570869e-06,   4.04548503e-06,
          1.03191130e-02,   5.66193495e-03,   4.61938367e-01,
         -0.00000000e+00,   6.41738359e-03,   1.98625504e-03,
         -0.00000000e+00,  -7.59521418e-03,   4.88380873e-02,
          9.26514901e-01,  -0.00000000e+00,   3.66504572e-01,
         -0.00000000e+00,  -1.26113747e-02,  -3.39155643e-01,
         -0.00000000e+00,  -4.50884370e-02,  -8.10747065e-02,
         -6.65402003e-02,   4.63454633e-01,   0.00000000e+00,
         -1.24678369e-01,  -2.22425380e-02,  -8.60624083e-04],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          1.67223792e-01,  -0.00000000e+00,   0.00000000e+00,
         -2.06691761e-03,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   1.72510829e-01,   0.00000000e+00,
          5.53311047e-01,  -0.00000000e+00,   0.00000000e+00,
         -1.62074348e-01,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   2.05288499e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  7.61083376e-04,   8.63894518e-04,   1.40540957e-02,
         -1.50214754e-02,   1.19103546e-01,  -1.03916491e-02,
         -0.00000000e+00,  -1.37294600e-02,   5.84631970e-02,
         -0.00000000e+00,  -2.89475060e-01,   2.15729637e+00,
         -1.55899135e-01,  -0.00000000e+00,   2.98831945e-02,
         -0.00000000e+00,   1.10206062e-01,  -1.53513496e-01,
         -0.00000000e+00,  -8.70481417e-01,   1.04098709e+00,
          1.80124452e+00,   2.87607889e+00,   0.00000000e+00,
          8.93468239e+00,  -7.92281602e-01,   4.13819582e+00],
       [ -1.01968490e-03,   1.11704147e-05,  -2.19082682e-04,
          1.12344917e-02,   5.25320835e-07,   1.75262520e-01,
         -0.00000000e+00,   1.52708006e-02,  -1.51382056e-02,
         -0.00000000e+00,   9.49109175e-03,   2.60497688e-02,
          1.86253688e-01,  -0.00000000e+00,  -4.08299412e-01,
         -0.00000000e+00,  -1.80609237e-02,   4.41183008e-01,
         -0.00000000e+00,   1.32646274e-01,   1.66264293e-01,
          2.66587599e-01,  -1.97575778e+00,   0.00000000e+00,
          5.42508289e-01,   6.25957938e-02,   6.10347643e-03],
       [  1.21873995e-03,   4.07253776e-01,  -9.46886597e-01,
          6.31674441e-02,  -5.56256250e-01,   6.21108067e-03,
         -0.00000000e+00,   2.42376778e-02,  -2.13112504e-03,
         -0.00000000e+00,   7.07760642e-01,  -1.82677481e+00,
          1.09768375e-01,  -0.00000000e+00,   5.17407901e-02,
         -0.00000000e+00,   4.48870453e-02,   7.41799348e-02,
         -0.00000000e+00,   1.46794432e-01,  -6.97243132e-02,
          1.49205442e+00,   2.34275671e-01,   0.00000000e+00,
          1.66795665e-01,  -1.96020215e-01,   4.64447364e-02],
       [  6.93189591e-04,   1.70222340e-01,  -3.07721764e-01,
         -5.57655463e-02,   6.31129464e-01,  -6.60562955e-04,
         -0.00000000e+00,  -3.00896435e-02,  -2.12234567e-01,
         -0.00000000e+00,  -4.62864870e-01,  -5.82995257e+00,
          4.60474276e-01,  -0.00000000e+00,  -7.03791015e-02,
         -0.00000000e+00,  -4.05046906e-01,  -3.26084393e-02,
         -0.00000000e+00,   1.05040726e-02,  -1.57717229e-01,
         -4.82617193e+00,  -1.02656499e+01,   0.00000000e+00,
         -3.27052074e+01,   9.10531496e-01,  -1.65539571e+01],
       [  3.35488030e-04,   6.46290122e-03,   3.28082493e-02,
         -2.25343127e-03,  -2.81965690e-02,  -1.14204415e-02,
         -0.00000000e+00,  -5.96947984e-03,  -1.82219729e-02,
         -0.00000000e+00,   5.98957127e-02,  -2.40664219e-01,
          9.71627516e-03,  -0.00000000e+00,   8.61639800e-03,
         -0.00000000e+00,  -1.01734228e-01,  -3.54272159e-02,
         -0.00000000e+00,  -5.62450871e-04,  -1.92179100e-01,
         -4.05381702e-03,   1.84761617e-01,   0.00000000e+00,
          7.20950252e-01,  -9.02949801e-01,   5.80132034e+00],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          4.65898727e-01,  -0.00000000e+00,   0.00000000e+00,
         -1.57485023e-04,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -9.31343959e-01,   0.00000000e+00,
         -4.71762336e-01,  -0.00000000e+00,   0.00000000e+00,
          1.32111131e-01,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,   4.75767822e-01,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [ -1.27211746e-04,  -1.89534644e-02,  -2.58172250e-02,
         -2.41953337e-02,   2.60949076e-01,  -2.69897297e-03,
         -0.00000000e+00,  -1.12169339e-02,  -2.32424245e-03,
         -0.00000000e+00,   6.21196775e-01,   8.79628935e-01,
         -5.53856571e-02,  -0.00000000e+00,   3.14255351e-02,
         -0.00000000e+00,  -4.36729538e-02,  -1.04584270e-02,
         -0.00000000e+00,  -1.71000776e-01,   2.35215694e-01,
         -1.81261815e+00,  -4.03221468e-01,   0.00000000e+00,
         -5.64030472e-01,  -1.49478859e-01,  -9.16587474e-02],
       [  1.17900713e-04,  -9.53570869e-06,  -4.04548503e-06,
          1.03191130e-02,   5.66193495e-03,   4.61938367e-01,
         -0.00000000e+00,   6.41738359e-03,  -1.98625504e-03,
         -0.00000000e+00,  -7.59521418e-03,  -4.88380873e-02,
         -9.26514901e-01,  -0.00000000e+00,   3.66504572e-01,
         -0.00000000e+00,   1.26113747e-02,  -3.39155643e-01,
         -0.00000000e+00,  -4.50884370e-02,  -8.10747065e-02,
          6.65402003e-02,  -4.63454633e-01,   0.00000000e+00,
          1.24678369e-01,  -2.22425380e-02,   8.60624083e-04],
       [  0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          1.67223792e-01,  -0.00000000e+00,   0.00000000e+00,
         -2.06691761e-03,   0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,  -1.72510829e-01,   0.00000000e+00,
          5.53311047e-01,  -0.00000000e+00,   0.00000000e+00,
         -1.62074348e-01,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -2.05288499e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [ -7.61083376e-04,  -8.63894518e-04,   1.40540957e-02,
          1.50214754e-02,  -1.19103546e-01,   1.03916491e-02,
         -0.00000000e+00,   1.37294600e-02,   5.84631970e-02,
         -0.00000000e+00,   2.89475060e-01,   2.15729637e+00,
         -1.55899135e-01,  -0.00000000e+00,  -2.98831945e-02,
         -0.00000000e+00,   1.10206062e-01,   1.53513496e-01,
         -0.00000000e+00,   8.70481417e-01,  -1.04098709e+00,
          1.80124452e+00,   2.87607889e+00,   0.00000000e+00,
          8.93468239e+00,   7.92281602e-01,   4.13819582e+00],
       [ -1.01968490e-03,   1.11704147e-05,   2.19082682e-04,
          1.12344917e-02,   5.25320835e-07,   1.75262520e-01,
         -0.00000000e+00,   1.52708006e-02,   1.51382056e-02,
         -0.00000000e+00,   9.49109175e-03,  -2.60497688e-02,
         -1.86253688e-01,  -0.00000000e+00,  -4.08299412e-01,
         -0.00000000e+00,   1.80609237e-02,   4.41183008e-01,
         -0.00000000e+00,   1.32646274e-01,   1.66264293e-01,
         -2.66587599e-01,   1.97575778e+00,   0.00000000e+00,
         -5.42508289e-01,   6.25957938e-02,  -6.10347643e-03]], dtype=float)

        self.assertTrue(np.allclose(cino, self.gdp.get_orbitals('ci'), rtol=1.0e-10, atol=1.0e-10))

    def test_datadict(self):
        self.assertIsInstance(self.gdp.parse_data(), dict)

    def test_parse_data_title(self):
        self.assertEqual('He-H2 FCI', self.gdp.parse_data()['title'])

    def test_parse_data_group(self):
        self.assertEqual('CNV      2', self.gdp.parse_data()['group'])


if __name__ == "__main__":
    unittest.main()
